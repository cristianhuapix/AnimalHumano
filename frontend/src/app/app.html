<header>
  <nav>
    <div class="logo">
      <a routerLink="/home">
        <img src="/logo.png" alt="Animal Humano" class="logo-img">
      </a>
    </div>
    @if (authService.isAuthenticated()) {
      <div class="hero-text">
        <h1>Bienvenido a Animal Humano</h1>
        <p>Tu plataforma integral para el cuidado y gesti贸n de mascotas</p>
      </div>
    }
    <div class="nav-links">
      @if (authService.isAuthenticated()) {
        <!-- Mode switcher para usuarios que son proveedores -->
        @if (authService.isProvider()) {
          <div class="mode-switcher">
            <button
              class="mode-btn"
              [class.active]="modeService.isUserMode()"
              (click)="switchToUserMode()"
              title="Cambiar a vista de usuario">
              
            </button>
            <button
              class="mode-btn"
              [class.active]="modeService.isProviderMode()"
              (click)="switchToProviderMode()"
              title="Cambiar a vista de proveedor">
              
            </button>
          </div>
        }

        <div class="user-menu desktop-menu">
          <!-- Nombre del usuario con icono -->
          <div class="user-info">
            <svg class="user-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span class="user-name">
              {{ authService.currentUser()?.first_name || (authService.currentUser()?.email?.split('@') || ['Usuario'])[0] }}
            </span>
          </div>

          <!-- Home Icon -->
          <a routerLink="/home" class="icon-btn home-btn" title="Inicio">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path>
              <path d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            </svg>
          </a>

          <!-- Notificaciones -->
          <a routerLink="/notifications" class="icon-btn" title="Notificaciones">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
          </a>

          <!-- Dashboard (solo admins) -->
          @if (authService.isAdmin()) {
            <a routerLink="/admin/dashboard" class="icon-btn" title="Administraci贸n">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 3v16a2 2 0 0 0 2 2h16"></path>
                <path d="M18 17V9"></path>
                <path d="M13 17V5"></path>
                <path d="M8 17v-3"></path>
              </svg>
            </a>
          }

          <!-- Configuraci贸n -->
          <a routerLink="/profile" class="icon-btn" title="Configuraci贸n">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
          </a>

          <!-- Logout -->
          <button class="icon-btn logout" (click)="signOut()" [disabled]="isLoggingOut()" [title]="isLoggingOut() ? 'Cerrando sesi贸n...' : 'Cerrar Sesi贸n'">
            @if (isLoggingOut()) {
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="spinner">
                <circle cx="12" cy="12" r="10" stroke-opacity="0.25"></circle>
                <path d="M12 2 A10 10 0 0 1 22 12" stroke-linecap="round"></path>
              </svg>
            } @else {
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
              </svg>
            }
          </button>
        </div>

        <!-- Home Icon - siempre visible -->
        <a routerLink="/home" class="icon-btn mobile-home-btn" title="Inicio">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path>
            <path d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
          </svg>
        </a>

        <!-- Bot贸n hamburguesa solo en mobile - al final -->
        <button class="hamburger-btn" (click)="toggleMobileMenu()" title="Men煤">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            @if (isMobileMenuOpen()) {
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            } @else {
              <line x1="3" y1="12" x2="21" y2="12"></line>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="3" y1="18" x2="21" y2="18"></line>
            }
          </svg>
        </button>
      } @else {
        <a routerLink="/home" routerLinkActive="active" class="nav-item">Inicio</a>
        <a routerLink="/auth/login" routerLinkActive="active" class="nav-item">Iniciar Sesi贸n</a>
        <a routerLink="/auth/register" routerLinkActive="active" class="nav-item">Registrarse</a>
      }
    </div>
  </nav>

  <!-- Men煤 m贸vil desplegable -->
  @if (authService.isAuthenticated() && isMobileMenuOpen()) {
    <div class="mobile-menu-overlay" (click)="closeMobileMenu()">
      <div class="mobile-menu" (click)="$event.stopPropagation()">
        <!-- Notificaciones -->
        <a routerLink="/notifications" class="mobile-menu-item" (click)="closeMobileMenu()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
          <span>Notificaciones</span>
        </a>

        <!-- Dashboard (solo admins) -->
        @if (authService.isAdmin()) {
          <a routerLink="/admin/dashboard" class="mobile-menu-item" (click)="closeMobileMenu()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 3v16a2 2 0 0 0 2 2h16"></path>
              <path d="M18 17V9"></path>
              <path d="M13 17V5"></path>
              <path d="M8 17v-3"></path>
            </svg>
            <span>Administraci贸n</span>
          </a>
        }

        <!-- Configuraci贸n -->
        <a routerLink="/profile" class="mobile-menu-item" (click)="closeMobileMenu()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
          <span>Configuraci贸n</span>
        </a>

        <!-- Logout -->
        <button class="mobile-menu-item logout-item" (click)="signOut(); closeMobileMenu()" [disabled]="isLoggingOut()">
          @if (isLoggingOut()) {
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="spinner">
              <circle cx="12" cy="12" r="10" stroke-opacity="0.25"></circle>
              <path d="M12 2 A10 10 0 0 1 22 12" stroke-linecap="round"></path>
            </svg>
          } @else {
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
          }
          <span>{{ isLoggingOut() ? 'Cerrando sesi贸n...' : 'Cerrar Sesi贸n' }}</span>
        </button>
      </div>
    </div>
  }
</header>

<main>
  <router-outlet />
</main>

<footer>
  <p>&copy; 2025 Animal Humano - Plataforma de Gesti贸n de Mascotas</p>
</footer>
